# Initialization
variable 	    dt equal {ts}
units 		    real
atom_style 	    {lmp_style}
boundary 	    p p p

# Forcefield parameters
{pair_style}
{bond_style}
{angle_style}

read_data 	    {data} nocoeff

{pair_coeff}
{bond_coeff}
{angle_coeff}

special_bonds 	lj/coul {sb}
neighbor	5.0 bin
neigh_modify 	delay 0 every 1 check yes

timestep	    $(v_dt)
thermo_style 	custom step temp press vol density ke pe etotal
thermo 	        100

velocity 	    all create 300.0 1234

# Remove high energy states
fix 		    1 all nve/limit {nve_ts}
fix 		    2 all temp/berendsen 300 300 $(10.0*v_dt)
run 		    $(1000/v_dt)
unfix 		    1
unfix 		    2

# Sample the CG system
reset_timestep	0
fix 		    1 all nvt temp 300 300 $(100*v_dt)
dump 		    1 all custom $(50/v_dt) {dump_path}/sample-s{sys}-i{i}.lammpstrj id mol type x y z
dump_modify 	1 sort id
run 		    $(50000/v_dt)

# Write down the data file
write_data      {data_path}/s{sys}-i{i}.lammps

